<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Galactic Investment Strategy</title>
  <style>
    body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
    .section { margin-bottom: 20px; }
    button { padding: 8px; margin: 5px; }
    table { border-collapse: collapse; width: 100%; font-size: 12px; }
    th, td { border: 1px solid #0f0; padding: 4px; text-align: center; }
    .log { color: #ff0; }
    #stockTableContainer { max-height: 600px; overflow-y: auto; border: 1px solid #0f0; }
  </style>
</head>
<body>
  <h1>🚀 Galactic Investment Strategy</h1>

  <div class="section">
    <p>Sol: <span id="sol">1</span></p>
    <p>Credits: <span id="credits">1000</span></p>
    <p>Protection Level: <span id="protection">0</span></p>
  </div>

  <div class="section">
    <h2>📈 Stock Market</h2>
    <div id="stockTableContainer">
      <table>
        <thead>
          <tr><th>Company</th><th>Trait</th><th>Price</th><th>Shares</th><th>Revenue</th><th>History</th><th>Actions</th></tr>
        </thead>
        <tbody id="stockTable"></tbody>
      </table>
    </div>
  </div>

  <div class="section">
    <h2>📦 Trade Contracts</h2>
    <button onclick="investContract('Titan Route')">Sign Titan Route (300)</button>
    <button onclick="investContract('Venus Express')">Sign Venus Express (300)</button>
    <p>Contracts: <span id="contracts"></span></p>
  </div>

  <div class="section">
    <h2>🛡 Security</h2>
    <button onclick="upgradeSecurity()">Upgrade Protection (100)</button>
  </div>

  <div class="section">
    <p class="log" id="log"></p>
    <p class="log" id="news"></p>
  </div>

  <script>
    let sol = 1;
    let credits = 1000;
    let protectionLevel = 0;
    let portfolio = {};
    let contracts = [];
    let stocks = {};
    let nextCompanySol = getNextCompanySol();

    function getNextCompanySol() {
      return sol + Math.floor(Math.random() * 7) + 6;
    }

    function randomTrait() {
      const traits = ['Stable', 'Volatile', 'Boom/Bust'];
      return traits[Math.floor(Math.random() * traits.length)];
    }

    function generateCompany() {
      const prefixes = ["Nova", "Quantum", "Solar", "Lunar", "Astro", "Nebula", "Ion"];
      const suffixes = ["Tech", "Mining", "Logistics", "Dynamics", "Systems", "Industries"];
      const name = `${prefixes[Math.floor(Math.random() * prefixes.length)]} ${suffixes[Math.floor(Math.random() * suffixes.length)]}`;
      stocks[name] = {
        price: Math.floor(Math.random() * 100) + 50,
        revenue: 0,
        history: [],
        trait: randomTrait()
      };
      log(`🆕 New company listed: ${name}`);
    }

    function getRevenueByTrait(trait) {
      if (trait === 'Stable') return Math.floor(Math.random() * 7) - 3;
      if (trait === 'Volatile') return Math.floor(Math.random() * 21) - 10;
      if (trait === 'Boom/Bust') return Math.floor(Math.random() * 41) - 20;
      return 0;
    }

    function renderHistoryGraph(history) {
      return history.slice(-10).map(val => val > 0 ? '+' : val < 0 ? '-' : '.').join('');
    }

    function generateNewsHeadline() {
      let totalRevenue = 0;
      let boomCount = 0;
      let bustCount = 0;

      for (let name in stocks) {
        const r = stocks[name].revenue;
        totalRevenue += r;
        if (r > 10) boomCount++;
        if (r < -10) bustCount++;
      }

      if (totalRevenue > 100) return "📢 AI Advisor: Market surging—consider aggressive buys.";
      if (totalRevenue < -100) return "📢 AI Advisor: Market downturn—consider selling volatile assets.";
      if (boomCount > bustCount) return "📢 AI Advisor: Tech sectors booming—watch for spikes.";
      if (bustCount > boomCount) return "📢 AI Advisor: Mining sectors struggling—expect dips.";
      return "📢 AI Advisor: Mixed signals—diversify your portfolio.";
    }

    function updateUI() {
      document.getElementById('sol').textContent = sol;
      document.getElementById('credits').textContent = credits;
      document.getElementById('protection').textContent = protectionLevel;

      const table = document.getElementById('stockTable');
      table.innerHTML = '';
      for (let name in stocks) {
        const stock = stocks[name];
        const owned = portfolio[name] || 0;
        table.innerHTML += `
          <tr>
            <td>${name}</td>
            <td>${stock.trait}</td>
            <td>${stock.price}</td>
            <td>${owned}</td>
            <td>${stock.revenue}</td>
            <td>${renderHistoryGraph(stock.history)}</td>
            <td>
              <button onclick="buy('${name}')">Buy</button>
              <button onclick="sell('${name}')">Sell</button>
            </td>
          </tr>
        `;
      }

      document.getElementById('contracts').textContent = contracts.join(', ') || 'None';
      document.getElementById('news').textContent = generateNewsHeadline();
    }

    function buy(name) {
      const price = stocks[name].price;
      if (credits >= price) {
        credits -= price;
        portfolio[name] = (portfolio[name] || 0) + 1;
        log(`Bought 1 share of ${name}`);
        updateUI();
      } else {
        log("Not enough credits.");
      }
    }

    function sell(name) {
      if ((portfolio[name] || 0) > 0) {
        credits += stocks[name].price;
        portfolio[name]--;
        log(`Sold 1 share of ${name}`);
        updateUI();
      } else {
        log("No shares to sell.");
      }
    }

    function investContract(route) {
      const cost = 300;
      if (credits >= cost) {
        credits -= cost;
        contracts.push(route);
        log(`Signed trade contract for ${route}`);
        updateUI();
      } else {
        log("Not enough credits.");
      }
    }

    function upgradeSecurity() {
      if (credits >= 100) {
        credits -= 100;
        protectionLevel++;
        log("Upgraded protection level.");
        updateUI();
      } else {
        log("Not enough credits.");
      }
    }

    function payDividends() {
      for (let company in portfolio) {
        const shares = portfolio[company];
        const dividend = shares * 2;
        credits += dividend;
      }
    }

    function payoutContracts() {
      let totalRevenue = 0;
      for (let name in stocks) totalRevenue += stocks[name].revenue;

      contracts.forEach(route => {
        let payout = 10;
        if (totalRevenue > 0) payout += 5;
        if (totalRevenue < 0) payout -= 5;
        credits += payout;
      });
    }

    function checkForPirates() {
      const risk = Math.random();
      if (risk > 0.8 - protectionLevel * 0.1) {
        const loss = Math.floor(Math.random() * 100);
        credits = Math.max(0, credits - loss);
        log(`🚨 Pirate raid! Lost ${loss} credits.`);
      }
    }

    function updateCompanyRevenue() {
      for (let name in stocks) {
        const stock = stocks[name];
        const revenue = getRevenueByTrait(stock.trait);
        stock.revenue = revenue;
        stock.price += revenue;
        stock.history.push(revenue);
      }
    }

    function removeDeadCompanies() {
      for (let name of Object.keys(stocks)) {
        if (stocks[name].price <= 0) {
          delete stocks[name];
          delete portfolio[name];
          log(`❌ ${name} collapsed and was delisted.`);
        }
      }
    }

    function nextSol() {
      sol++;
      updateCompanyRevenue();
      removeDeadCompanies();
      payDividends();
      payoutContracts();
      checkForPirates();

      if (sol >= nextCompanySol) {
        generateCompany();
        nextCompanySol = getNextCompanySol();
      }

      log(`Sol ${sol}: Revenue updated. Time the market wisely.`);
      updateUI();
    }

    function log(msg) {
      document.getElementById('log').textContent = msg;
    }

    // Initialize game with 21 companies
    for (let i = 0; i < 21; i++) {
      generateCompany();
    }

    updateUI();
    setInterval(nextSol, 15000); // 1 sol = 15 seconds
  </script>
</body>
</html>